#!/bin/bash

MAX_SIZE=900
MAX_DIMENSION=1200

for f in $@; do
    SIZE=$(ls -s1 $f | awk -F" " '{ print $1}')
    WIDTH=$(identify $f | awk -F" " '{ print $3}' | cut -d 'x' -f 1)
    HEIGHT=$(identify $f | awk -F" " '{ print $3}' | cut -d 'x' -f 2)

    if (( $SIZE > $MAX_SIZE )); then
        echo " "
        echo "-----------------------"
        echo $f is too big
        echo "size: ${SIZE}kb | dimensions: ${WIDTH}x${HEIGHT}"

        if (( $WIDTH > $HEIGHT )); then
            echo $f is LANDSCAPE
            chafa -s 80x25 $f
            ffmpeg -i $f -vf "scale=1280:-2" ${f%%.*}.jpg
        else
            echo $f is PORTRAIT
            chafa -s 25x80 $f
            ffmpeg -i $f -vf "scale=-2:1280" ${f%%.*}.jpg
        fi
        echo " "
    fi
done
